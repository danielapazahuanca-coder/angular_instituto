<!-- app.component.html -->
<div class="min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-4">

  <!-- Stepper -->
  <div class="max-w-7xl mx-auto px-4 py-8">
    <div class="flex items-center justify-between mb-6">
      <ng-container *ngFor="let step of steps; let i = index; let last = last">
        <div class="flex flex-col items-center flex-1">
          <div
            class="w-12 h-12 rounded-full flex items-center justify-center transition-all duration-300"
            [ngClass]="{
              'bg-green-500 text-white': currentStep > step.number,
              'bg-blue-600 text-white ring-4 ring-blue-200': currentStep === step.number,
              'bg-gray-200 text-gray-500': currentStep < step.number
            }"
          >
            <ng-container [ngSwitch]="getStepIcon(step.number)">
              <svg *ngSwitchCase="'check'" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-check w-6 h-6">
                <path d="M20 6 9 17l-5-5" />
              </svg>
              <svg *ngSwitchCase="'user'" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-user w-6 h-6">
                <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
                <circle cx="12" cy="7" r="4" />
              </svg>
              <svg *ngSwitchCase="'book-open'" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" class="lucide lucide-book-open w-6 h-6">
                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
              </svg>
              <svg *ngSwitchCase="'calendar'" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" class="lucide lucide-calendar w-6 h-6">
                <rect width="18" height="18" x="3" y="4" rx="2" ry="2" />
                <line x1="16" x2="16" y1="2" y2="6" />
                <line x1="8" x2="8" y1="2" y2="6" />
                <line x1="3" x2="21" y1="10" y2="10" />
              </svg>
              <svg *ngSwitchCase="'credit-card'" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                stroke-linejoin="round" class="lucide lucide-credit-card w-6 h-6">
                <rect width="20" height="14" x="2" y="5" rx="2" />
                <line x1="2" x2="22" y1="10" y2="10" />
              </svg>
            </ng-container>
          </div>
          <span
            class="mt-2 text-sm font-medium text-center"
            [ngClass]="currentStep >= step.number ? 'text-gray-900' : 'text-gray-400'"
          >
            {{ step.title }}
          </span>
        </div>
        <div
          *ngIf="!last"
          class="h-1 flex-1 mx-4"
          [ngClass]="currentStep > step.number ? 'bg-green-500' : 'bg-gray-200'"
        ></div>
      </ng-container>
    </div>

    <!-- Contenido del paso -->
    <div class="bg-white rounded-2xl shadow-xl p-6">
      <!-- PASO 1: Datos Personales -->
      <div *ngIf="currentStep === 1" class="space-y-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">Datos Personales</h2>
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Nombre *</label>
            <input type="text" placeholder="Ingrese su nombre" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Apellido Paterno *</label>
            <input type="text" placeholder="Ingrese apellido paterno" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Apellido Materno</label>
            <input type="text" placeholder="Ingrese apellido materno" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Cédula de Identidad *</label>
            <input type="text" placeholder="Ej: 1234567 LP" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Email *</label>
            <input type="email" placeholder="correo@ejemplo.com" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Celular *</label>
            <input type="tel" placeholder="7XXXXXXX" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Fecha de Nacimiento *</label>
            <input type="text" placeholder="dd/mm/aaaa" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Género *</label>
            <select class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
              <option value="">Seleccione...</option>
              <option value="M">Masculino</option>
              <option value="F">Femenino</option>
              <option value="Otro">Otro</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Dirección</label>
            <textarea rows="2" placeholder="Ingrese su dirección completa" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
          </div>
        </div>
      </div>

      <!-- PASO 2: Información Académica -->
      <div *ngIf="currentStep === 2" class="space-y-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">Información Académica</h2>
        
        <!-- Tipo de estudiante -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-4">Tipo de Estudiante *</label>
          <div class="grid grid-cols-1 gap-4">
            <div 
              (click)="studentType = 'nivelacion'"
              class="p-4 border-2 rounded-lg cursor-pointer transition-all duration-300"
              [ngClass]="studentType === 'nivelacion' ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-blue-300'">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-book-open w-6 h-6" [ngClass]="studentType === 'nivelacion' ? 'text-blue-600' : 'text-gray-400'">
                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
                  </svg>
                  <div>
                    <h3 class="font-semibold text-gray-900">Nivelación</h3>
                    <p class="text-sm text-gray-600">Programa preparatorio antes de iniciar carrera</p>
                  </div>
                </div>
                <svg *ngIf="studentType === 'nivelacion'" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round" class="lucide lucide-check-circle w-5 h-5 text-blue-600">
                  <circle cx="12" cy="12" r="10" />
                  <path d="m9 12 2 2 4-4" />
                </svg>
              </div>
            </div>

            <div 
              (click)="studentType = 'carrera'"
              class="p-4 border-2 rounded-lg cursor-pointer transition-all duration-300"
              [ngClass]="studentType === 'carrera' ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-blue-300'">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-book-open w-6 h-6" [ngClass]="studentType === 'carrera' ? 'text-blue-600' : 'text-gray-400'">
                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
                  </svg>
                  <div>
                    <h3 class="font-semibold text-gray-900">Carrera Profesional</h3>
                    <p class="text-sm text-gray-600">Programa completo de formación profesional</p>
                  </div>
                </div>
                <svg *ngIf="studentType === 'carrera'" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round" class="lucide lucide-check-circle w-5 h-5 text-blue-600">
                  <circle cx="12" cy="12" r="10" />
                  <path d="m9 12 2 2 4-4" />
                </svg>
              </div>
            </div>
          </div>
        </div>

        <!-- Selección de carrera (solo si es carrera profesional) -->
        <div *ngIf="studentType === 'carrera'" class="animate-fadeIn">
          <label class="block text-sm font-medium text-gray-700 mb-4">Seleccione su Carrera *</label>
          <div class="space-y-3">
            <div 
              *ngFor="let career of careers"
              (click)="selectedCareer = career.code"
              class="p-4 border-2 rounded-lg cursor-pointer transition-all duration-300"
              [ngClass]="selectedCareer === career.code ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-blue-300'">
              <div class="flex items-center justify-between">
                <div>
                  <h4 class="font-semibold text-gray-900">{{ career.name }}</h4>
                  <p class="text-sm text-gray-600 mt-1">Código: {{ career.code }} • Duración: {{ career.duration }} semestres</p>
                </div>
                <svg *ngIf="selectedCareer === career.code" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                  viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round" class="lucide lucide-check-circle w-5 h-5 text-blue-600">
                  <circle cx="12" cy="12" r="10" />
                  <path d="m9 12 2 2 4-4" />
                </svg>
              </div>
            </div>
          </div>
        </div>

        <!-- Información importante -->
        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
          <div class="flex items-start">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="lucide lucide-alert-circle w-5 h-5 text-blue-500 mr-3 mt-0.5">
              <circle cx="12" cy="12" r="10" />
              <line x1="12" x2="12" y1="8" y2="12" />
              <line x1="12" x2="12.01" y1="16" y2="16" />
            </svg>
            <div class="text-sm text-blue-800">
              <p class="font-medium mb-1">Información importante:</p>
              <p>Se generará automáticamente tu código de estudiante y serás asignado al nivel 1 de tu programa.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- PASO 3: Selección de Materias -->
      <div *ngIf="currentStep === 3" class="space-y-6">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-2xl font-bold text-gray-900">Materias Disponibles - Semestre 1</h2>
          <div class="text-sm text-gray-600 bg-gray-100 px-4 py-2 rounded-lg">Periodo: 1/2024</div>
        </div>

        <div class="space-y-4">
          <div *ngFor="let group of availableGroups" class="p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow">
            <div class="flex items-start justify-between">
              <div class="flex-1">
                <div class="flex items-center gap-3 mb-3">
                  <h3 class="text-lg font-bold text-gray-900">{{ group.subject }}</h3>
                  <span class="px-2 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded">{{ group.code }}</span>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600 mb-3">
                  <div class="flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                      class="lucide lucide-user w-4 h-4 mr-2">
                      <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
                      <circle cx="12" cy="7" r="4" />
                    </svg>
                    <span>{{ group.professor }}</span>
                  </div>
                  <div class="flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                      class="lucide lucide-clock w-4 h-4 mr-2">
                      <circle cx="12" cy="12" r="10" />
                      <polyline points="12 6 12 12 16 14" />
                    </svg>
                    <span>{{ group.schedule }}</span>
                  </div>
                  <div class="flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                      class="lucide lucide-calendar w-4 h-4 mr-2">
                      <rect width="18" height="18" x="3" y="4" rx="2" ry="2" />
                      <line x1="16" x2="16" y1="2" y2="6" />
                      <line x1="8" x2="8" y1="2" y2="6" />
                      <line x1="3" x2="21" y1="10" y2="10" />
                    </svg>
                    <span>{{ group.room }}</span>
                  </div>
                  <div class="flex items-center">
                    <span
                      class="px-2 py-1 rounded text-xs font-medium"
                      [ngClass]="{
                        'bg-blue-100 text-blue-700': group.modality === 'Presencial',
                        'bg-purple-100 text-purple-700': group.modality === 'Virtual',
                        'bg-orange-100 text-orange-700': group.modality === 'Híbrida'
                      }"
                    >
                      {{ group.modality }}
                    </span>
                  </div>
                </div>

                <div class="flex items-center gap-4">
                  <div class="flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium"
                    [ngClass]="getAvailabilityColor(group.enrolled, group.capacity)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                      class="lucide lucide-users w-4 h-4">
                      <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
                      <circle cx="9" cy="7" r="4" />
                      <path d="M22 21v-2a4 4 0 0 0-3-3.87" />
                      <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                    </svg>
                    <span>{{ group.capacity - group.enrolled }} cupos disponibles</span>
                  </div>
                  <div class="text-sm font-semibold text-gray-900">Bs. {{ group.cost }}</div>
                </div>
              </div>

              <button 
                (click)="toggleSelection(group.id)"
                class="ml-4 px-4 py-2 rounded-lg font-medium transition-colors"
                [ngClass]="{
                  'bg-blue-600 text-white hover:bg-blue-700': !isSelected(group.id),
                  'bg-red-500 text-white hover:bg-red-600': isSelected(group.id)
                }">
                {{ isSelected(group.id) ? 'Quitar' : 'Inscribir' }}
              </button>
            </div>
          </div>
        </div>

        <div *ngIf="selectedGroups.length > 0" class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
          <p class="text-green-800 font-medium">
            {{ selectedGroups.length }} materia{{ selectedGroups.length > 1 ? 's' : '' }} seleccionada{{ selectedGroups.length > 1 ? 's' : '' }}
          </p>
        </div>
      </div>

      <!-- PASO 4: Confirmación y Pago -->
      <div *ngIf="currentStep === 4" class="space-y-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">Confirmación de Inscripción</h2>

        <!-- Resumen de Materias -->
        <div class="bg-gray-50 rounded-xl p-6">
          <h3 class="text-lg font-bold text-gray-900 mb-4">Materias Inscritas</h3>
          <div class="space-y-3">
            <div *ngFor="let group of selectedGroups" class="bg-white p-4 rounded-lg border border-gray-200">
              <div class="flex items-start justify-between">
                <div>
                  <p class="font-semibold text-gray-900">{{ group.subject }}</p>
                  <p class="text-sm text-gray-600 mt-1">{{ group.schedule }}</p>
                  <p class="text-sm text-gray-600">{{ group.professor }}</p>
                </div>
                <p class="font-bold text-blue-600">Bs. {{ group.cost }}</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Resumen de Pagos -->
        <div class="bg-blue-50 rounded-xl p-6 mb-6">
          <h3 class="text-lg font-bold text-gray-900 mb-4">Resumen de Costos</h3>
          <div class="space-y-3">
            <div class="flex justify-between py-2 border-b border-blue-200">
              <span class="text-gray-700">Inscripción</span>
              <span class="font-semibold">Bs. 500</span>
            </div>
            <div class="flex justify-between py-2 border-b border-blue-200">
              <span class="text-gray-700">Materias ({{ selectedGroups.length }})</span>
              <span class="font-semibold">Bs. {{ totalCost }}</span>
            </div>
            <div class="flex justify-between py-3 text-lg font-bold text-blue-900 border-t-2 border-blue-300 mt-2">
              <span>Total</span>
              <span>Bs. {{ 500 + totalCost }}</span>
            </div>
          </div>
        </div>

        <!-- Forma de pago -->
        <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
          <div class="flex items-start">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="lucide lucide-alert-circle w-5 h-5 text-yellow-600 mr-3 mt-0.5">
              <circle cx="12" cy="12" r="10" />
              <line x1="12" x2="12" y1="8" y2="12" />
              <line x1="12" x2="12.01" y1="16" y2="16" />
            </svg>
            <div class="text-sm text-yellow-800">
              <p class="font-medium mb-1">Forma de pago</p>
              <p>Deberá completar el pago en secretaría dentro de las próximas 48 horas para confirmar su inscripción.</p>
            </div>
          </div>
        </div>

        <!-- Horario Visual -->
        <div class="bg-gray-50 rounded-xl p-6">
          <h3 class="text-lg font-bold text-gray-900 mb-4">Tu Horario Semanal</h3>
          <div class="bg-white rounded-lg p-4 border border-gray-200">
            <div class="grid grid-cols-6 gap-2 text-sm">
              <div class="font-semibold text-center py-2 bg-gray-50 rounded">Hora</div>
              <div class="font-semibold text-center py-2 bg-gray-50 rounded">Lunes</div>
              <div class="font-semibold text-center py-2 bg-gray-50 rounded">Martes</div>
              <div class="font-semibold text-center py-2 bg-gray-50 rounded">Miércoles</div>
              <div class="font-semibold text-center py-2 bg-gray-50 rounded">Jueves</div>
              <div class="font-semibold text-center py-2 bg-gray-50 rounded">Viernes</div>

              <div class="text-center py-3 bg-gray-50 rounded">08:00-10:00</div>
              <div *ngIf="hasSubject('Matemáticas I', 'Lunes')" class="bg-blue-100 text-blue-900 p-2 rounded text-center font-medium">Matemáticas I</div>
              <div *ngIf="!hasSubject('Matemáticas I', 'Lunes')" class="bg-gray-100 rounded"></div>
              <div *ngIf="hasSubject('Matemáticas I', 'Miércoles')" class="bg-blue-100 text-blue-900 p-2 rounded text-center font-medium">Matemáticas I</div>
              <div *ngIf="!hasSubject('Matemáticas I', 'Miércoles')" class="bg-gray-100 rounded"></div>
              <div *ngIf="hasSubject('Inglés Técnico I', 'Viernes')" class="bg-purple-100 text-purple-900 p-2 rounded text-center font-medium">Inglés</div>
              <div *ngIf="!hasSubject('Inglés Técnico I', 'Viernes')" class="bg-gray-100 rounded"></div>

              <div class="text-center py-3 bg-gray-50 rounded">14:00-16:00</div>
              <div *ngIf="hasSubject('Programación I', 'Martes')" class="bg-green-100 text-green-900 p-2 rounded text-center font-medium">Programación I</div>
              <div *ngIf="!hasSubject('Programación I', 'Martes')" class="bg-gray-100 rounded"></div>
              <div *ngIf="hasSubject('Programación I', 'Jueves')" class="bg-green-100 text-green-900 p-2 rounded text-center font-medium">Programación I</div>
              <div *ngIf="!hasSubject('Programación I', 'Jueves')" class="bg-gray-100 rounded"></div>
              <div class="bg-gray-100 rounded"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Botones de navegación -->
      <div class="flex justify-between mt-8 pt-6 border-t border-gray-200">
        <button
          type="button"
          (click)="goToPrevious()"
          [disabled]="currentStep === 1"
          class="px-6 py-3 rounded-lg font-medium transition-all duration-300"
          [ngClass]="{
            'bg-gray-100 text-gray-400 cursor-not-allowed': currentStep === 1,
            'bg-gray-200 text-gray-700 hover:bg-gray-300': currentStep > 1
          }"
        >
          Anterior
        </button>

        <button
          type="button"
          (click)="goToNext()"
          class="boton_siguiente"
        >
          {{ currentStep === 4 ? 'Confirmar Inscripción' : 'Siguiente' }}
        </button>
      </div>
    </div>
  </div>
</div>
